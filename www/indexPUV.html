<!DOCTYPE html>
<html><!--HTML5 doctype-->
<!-- 
  Změny:
    2014-07-05  Zrušen help u nevím a odstraněn pes

-->
<head>
<meta http-equiv="Content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta http-equiv="Pragma" content="no-cache">

<link href="css/icons.css" rel="stylesheet" type="text/css">
<link href="css/af.ui.css" rel="stylesheet" type="text/css">  
<link rel="stylesheet" type="text/css" href="animate.css" >
<link href="my.css" rel="stylesheet" type="text/css">

<script type="text/javascript" charset="utf-8" src="appframework.js"></script>

<script type="text/javascript" charset="utf-8" src="filesmuj.js"></script>
<script type="text/javascript" charset="utf-8" src="filesystem.js"></script>

<script type="text/javascript" charset="utf-8" src="DBapi.js"></script>

<script type="text/javascript" language="javascript">


//initial event handler to detect when intel is ready to roll
    //document.addEventListener("intel.xdk.device.ready", onDeviceReady, false);
    isChrome = !!(window.chrome && chrome.webstore && chrome.webstore.install);
    //setTimeout("onDeviceReady();", 2000);

    
//  When the program is ready
    function ProgramReady() {
        app.log("ProgramReady !! OKej ");
        //hide splash screen now that our app is ready to run
        setTimeout(function () {
        $.ui.launch();
        }, 250);
        
        // ****  ovladani tlacitek menu a back  ****
        //document.addEventListener("menubutton", onMenuKeyDown, false );
        document.addEventListener("backbutton", onBackKeyDown, false); 

         // **** otevreni SQL databaze  ****        
         DBAPI.otevriDB(); 
         //
         // $.ui.popup('DB is OPEN');
    
        // vypln(1);    // ??? zacinat od prvniho slova ???
        // zavolame si o prvni slovo a vysledek zobrazi funkce vypln
        // DBAPI.dejNextSlovo(vypln);  

    
    
    };

   // Handle the back button    //
   function onBackKeyDown() { 
    $.ui.popup( {
     title:"Ukončit ?",
     message:"Ukončit program Šprt ? <br/>" + pathRootAdr,
     cancelText:"Pokračovat",
     cancelCallback: function(){console.log("cancelled");},
     doneText:"KONEC!",
     doneCallback: function(){navigator.app.exitApp();},
     cancelOnly:false
    });
    return true;
    }
         
    function nactiDataResetXX(path)
    // nacte nova data a resetuje zobrazeni
    {
      nactiData(path);
      DBAPI.dejNextSlovo(vypln);  
      gotoPage("Zkouseni");
      $.ui.setTitle(nazevLekce);
	  console.log("Reading the remote DB finished OK.");
      // 
    }
    
    function nactiData(path)
    {
    pathRootAdr = path;       // zapamatujeme si odkud se nacitalo naposled
    xmlData = null;           // mozna vymazat stara data
    xmlData = loadXMLDoc(pathRootAdr + "lekcetest1.xml");
    // xmlData = loadXMLbezErr("file:///android_asset/www/lekcetest1.xml");
    $("#lastlekce").html(pathRootAdr + "lekcetest1.xml");
    xslJednoSlovo = loadXMLDoc(pathRootAdr + "jednoslovo.xsl"); 
    // alert("NACITANI " + pathRootAdr + "katvozlist.xml");
    if((xmlData == null)||(xslJednoSlovo == null)){
    $.ui.popup( {
     title:"Bacha !",
     message:"Nenačtena data z adresáře: <br/>" + pathRootAdr + "<br/>lekcetest1.xml . . . . ",
     cancelText:"Konec",
     cancelCallback: function(){console.log("cancelled");},
     doneText:"OK!",
     doneCallback: function(){console.log("Done for!");},
     cancelOnly:false
    });
    }
    // do nadpisu nazev lekce
    nazevLekce = xmlData.getElementsByTagName("ORIGIN")[0].getElementsByTagName("SESTAVATX")[0].textContent;
    // opravit aktualni status
    // aktStatus.Celkem = xmlData.getElementsByTagName("R").length;
    aktStatus.Index = 1;
    aktStatus.Znam = 0;
    aktStatus.Neznam = 0;
    
    };
    
    function gotoPage(page)
    {
      window.location.href = "#"+page;
    }
    
    
</script>
<script src="js/appframework.ui.min.js"></script>
<script>
    $.ui.autoLaunch  = false;
    $.ui.useOSThemes = false; //Change this to false to force a device theme
    $.ui.blockPageScroll();
    $(document).ready(function () {
        if ($.ui.useOSThemes && !$.os.ios && $("#afui").get(0).className !== "ios")
            $("#afui").removeClass("ios");
            
            
    }
    );
    

$.ui.ready(
    function(){
    
    $.ui.backButtonText='Zpět';
    $.ui.showBackButton=true;
    //$.ui.updateBadge("#idtext",DBAPI.dbRow.fromLang,"tl");          //Badge will appear on the top left
    $.ui.updateBadge("#znam","Yes","tl","green");      //Badge will appear on the top left
    $.ui.updateBadge("#neznam","No","tl","red");    //Badge will appear on the top left
    $.ui.updateBadge("#celkem","Total words","tl","black");  //Badge will appear on the top left

    
        // zobrazi panel historie pomoci pop
           // alert("UIREADY");
           // $.ui.loadContent("historie",false,false,"pop");     

       document.addEventListener("unloadpanel", onUnloadpanel, false);           
       document.addEventListener("loadpanel", onLoadpanel, false);
       // document.addEventListener("swipeUp", onSwipeup, false);           
       $("#Zkouseni").bind("swipeDown", onSwipedown);
       $("#Zkouseni").bind("swipeUp", onSwipeup); 
       // $("#Zkouseni").on("tap","#slovo",onTap);
       $("#slovo").bind("click",onTap);       
       $("#mysipka").bind("click",onReverse);       
     }
);
 
 //tap 		similar to click
 //singleTap	tapped once
 //doubleTap 	two quick taps
 //longTap 	Long press tap
 //swipe 	screen was swiped
 //swipeLeft 	screen was swiped left
 //swipeRight 	screen was swiped right
 //swipeUp 	screen was swiped up
 //swipeDown 	screen was swiped down

    function onReverse(e) {
    //  app.log("onReverse: "+e.srcElement.id);
    DBAPI.reverse(); 
    canim('#mysipka','animated flip',500);
    }
 
// This event handler is fired when panel is loaded
    function onUnloadpanel(e) {
     app.log("onUnloadpanel: "+e.srcElement.id);
     }
    function onLoadpanel(e) {
     app.log("onLoadpanel: "+e.srcElement.id);
     if(e.srcElement.id === 'Zkouseni') 
        $.ui.setTitle(nazevLekce);
     
     if(e.srcElement.id === 'Historie')
     {
        var i=0;    
        var s = " dbRow : <br/>";
        							
	s = s + "iRowId = " + DBAPI.dbRow.iRowId + "<br/>";
	
	s = s + "w1 = " + DBAPI.dbRow.w1 + "<br/>";
	s = s + "n1 = " + DBAPI.dbRow.n1 + "<br/>";
	
	s = s + "w2[..] = " +  DBAPI.dbRow.w2.toString() + "<br/>";
	s = s + "n2[..] = " +  DBAPI.dbRow.n2.toString() + "<br/>";
	s = s + "c2[..] = " +  DBAPI.dbRow.c2.toString() + "<br/>";
 
	$("#idhis").html(s);
      }
     };   
   
// This event 
    function onSwipeup(e) {
     console.log("onSwipe UP: "+e.srcElement);
     znam();
     // navigator.notification.vibrateWithPattern([0, 100,100, 800]);
    }
    function onSwipedown(e) {
     console.log("onSwipe Down: "+e.srcElement);
     neznam();
     // navigator.notification.beep(1);
     // navigator.notification.vibrateWithPattern([0, 100, 100, 200, 100, 400, 100, 800]);
    }
    function onTap(e) {
     console.log("on Tap: "+e.srcElement+" id=" + e.srcElement.id+" type=" + e.type+" cX=" + e.clientX);
     otoc();
	 if (navigator.notification) // if value defined
		navigator.notification.vibrateWithPattern([0, 100]);
     return true;
    }


</script>

  <script type="text/javascript">    
//***********************************************************
//
//   aktualni stav zkouseni = status právě zkoušené lekce
//
  var aktStatus =
  {
    idLekce: 0,
    odTime:0,
    doTime:0,
    lastIndex:0,
    Index:0,
    Znam:0,
    Neznam:0
    
  	  
  }

    function flip()
    {
       // $.ui.loadContent("#page1",false,false,"pop");
       $.ui.runTransition("up",slovo1,slovo,false);

       // alert("flip " + $('#page1'));
    }
    
    function anim1()
    {
       $("#slovo").addClass("animated flip");
       // $("#slovo").removeClass("animated flip");
       // $("#slovo").addClass("flip");
       // alert("flip " + $('#page1'));
    }
    function odanim1()
    {
       $("#slovo").removeClass("animated");
       $("#slovo").removeClass("flip");
       // alert("flip " + $('#page1'));
    }


    function canim(blok,cssanim,cas)
    // animace bloku slovo
    {
       $(blok).addClass(cssanim);      
       var Timer = setInterval(function()
       	      {
       	         clearInterval(Timer);
       	      	 Timer = null;
       	      	 $(blok).removeClass(cssanim);
       	      	 //$(blok).removeClass("flip");
               }
       	      ,cas);
    }

	/* DBAPI.dbRow:
	w1: "w1w1w1",         // anglicky = dotazovane slovo
	w2: ["w2.1", "w2.2"], // rusky = seznam moznych odpovedi
	n1: '',               // noun 1
	n2: ["n2.1", "n2.2"], // verb 2.1, noun 2.2
	c2: [0.101, 0.102],   // pravdepodobnost 1, pravdepodobnost 2
	iPocetSlovCelkem: (-3),
	fromLang: "En2",
	toLang: "Fr2",
	nowLang: "En3",
	iRowId: 0 // cislo radky
       },
    index: 0,
    nazev: "Book 001 lesson 002",
	*/
	
  function animHelp()  
  // zobrazi waitblock a animuje cekani
  // nakonec se vrati na prvni obrazovku 
  { var date = new Date();
    var s, iColor = 'grey';
    var options = {
        weekday: "long",
        year: "numeric",
        month: "numeric",
        day: "numeric",
        hour: "numeric",
        minute: "numeric",
        second: "numeric",
        hour12: false
    };

    var s =  '';
	
	s = DBAPI.nazev + date.toLocaleDateString("en-GB-oed", options) + ' ' + date.toLocaleTimeString("en-GB-oed", options) 
	+ "<br/>"; 
	
	myProcent = 0;
	myProcent = Math.round(DBAPI.dbRow.c2[0]*100);
	myProcent = 77;
	
    iColor1 = 'green'; //'lime';
	iColor2 = 'lime'; //'orange';
	iColor3 = 'magenta';
	iColor4 = 'red'; //#F75D59'; // red
	
	s = s + '<br/><P><P><font size="7" color="' + iColor1 + '">' + DBAPI.dbRow.fromLang + ": '" + DBAPI.dbRow.w1 
	+ "' </font>" 
	+ '<font size="6" color="' + iColor2 + '"> (' + myProcent + "%)" + "</font>, " + "<br/><P>" 
	+ '<font size="8" color="' + iColor4 + '">' + DBAPI.dbRow.toLang + ": '";
	
	var strCarka=" ", iC = 0;
    for (var p in DBAPI.dbRow.w2) {	
           //s = s + "<br/>" +  DBAPI.dbRow.w2[p];
		   s = s + strCarka + DBAPI.dbRow.w2[p];
		   if (iC > 2 ) {
			strCarka = ",<BR/><P> ";
			iC=0;
			}
			else {
				strCarka = ", ";
				iC++;
				};
    };
	s = s + "'";	
	
	console.log("animHelp(), s=|" + s + '|');
    $("#helptx").html(s);
    document.getElementById("waitblock").style.display = 'block';
    var aid = document.getElementById("waitblock");	
        aid.style.display = 'block';
        // alert("startBadAns " + aid);
        $("#waitblock").addClass('waitblock2');
         var uvodTimer = setInterval(function()
    	      {
    	      	   clearInterval(uvodTimer);
    	      	   uvodTimer = null;
    	           // ulozSettingsAll();
    	           // gototab(seznam1Str);
    	           $("#waitblock").removeClass('waitblock2');
           }
    	      ,7000); // 9 sec ?
    
  };
    
    
    function vypln(slovo)
    // slovo je objekt (dbRow) obsahujici slova v obou jazycich
    {
      var s = '', s2='';
	  
    iColor1 = 'green'; //'lime';
	iColor2 = 'lime'; //'orange';
	iColor3 = 'magenta';
	iColor4 = 'red'; //#F75D59'; // red
	
	s2 = slovo.w2.toString();
	s3 = slovo.w2;
	s4 = s2;
	//if( Object.prototype.toString.call( someVar ) === '[object Array]' ) {
	if (s3.isArray) {
		for (var p in s3) {
			var s5='', carka = ",?", iC=0;
			console.log("----s5=|" + s5 + '|');
			s5 = s5 + s3[p] + carka;
		if (iC > 4) {
		carka = ",!<P>";
		iC=0;
		}
		else {
		iC++;
		}
		s4 = s5;
		};
	}
	else {
	s3 = s2.split(','); // s3 je string
	for (var p in s3) {
			var s5='', carka = " ", iC=0;
			//console.log("----s5=|" + s5 + '|');
			s5 = s5 + s3[p] + carka;
		if (iC > 4) {
		carka = ",<P>";
		iC=0;
		}
		else {
		iC++;
		carka = ", ";
		}
		s4 = s5;
		};
	};
	
	console.log(s3);
	
	   s='<div id="tabs-0" class="tab"> <div id="Word1"> ' +  '<font color="' + iColor1 + '">' +
       slovo.w1 + "</font>" +
       '</div> <div id="Word2"> ' +  '<font color="' + iColor4 + '">' +
       s4 + "</font>" +
       '</div></div> ';	  
       
	   // console.log(DBAPI.result7); global na zobrazeni
	   
      $("#slovo").html(s);
      // $.ui.updateBadge("#mysipka",DBAPI.dbRow.fromLang,"tl","green"); //Badge will appear on the top left
      // $.ui.updateBadge("#mysipka",DBAPI.dbRow.toLang,"dr","red"); 
      $("#mysipka").html(" >> Překlad z " + DBAPI.dbRow.fromLang + " >> do jazyka: " + DBAPI.dbRow.toLang + "  >>");
      $.ui.updateBadge("#slovo",DBAPI.dbRow.fromLang,"tl","green");   //Badge will appear on the top left
	 // DBAPI.dbRow.nowLang = DBAPI.dbRow.toLang; // jazyk po otoceni
      $("#Word1").show();
      $("#Word2").hide();
      // canim('#slovo','animated flipInX',1000);
      showStatus(); 
      }
	   
    function showStatus()
    {
       $("#znamx").html(aktStatus.Znam); 
       $("#neznamx").html(aktStatus.Neznam); 
       $("#celkemx").html(DBAPI.dbRow.iPocetSlovCelkem); 
       $.ui.setTitle(DBAPI.nazev);
    
    }
    function znam()
    {
    // zavola si o dalsi slovo a vysledek zobrazi funkce vypln
      DBAPI.znam();
      DBAPI.dejNextSlovo(vypln);  
      aktStatus.Znam++;
      aktStatus.Index++;
      showStatus();
    }
    function neznam()
    {
      DBAPI.neznam();
      // animHelp();
      DBAPI.dejNextSlovo(vypln);  
      aktStatus.Neznam++;
      aktStatus.Index++;
      showStatus();
    }
    function otoc()
    {
      // konvertXmlToTarget(xmlData,xslJednoSlovo,aktStatus.Index,"slovo");      
      canim('#slovo','animated flip',1000);
      $("#Word1").toggle();
      $("#Word2").toggle();
      $.ui.updateBadge("#slovo",DBAPI.dbRow.nowLang,"tl","green"); //Badge will appear on the top left
	  // DBAPI.dbRow.nowLang = DBAPI.dbRow.fromLang; // jazyk pred otocenim
    }
    

   // action sheet =  volba na spodu obrazofky
   function actionmy(){
   $.ui.actionsheet("<a href='javascript:;' class='button'>S e t u p</a>"+ 
                    "<a href='javascript:navigator.app.exitApp();' class='button red'> * E N D * </a>")
   }
   
   
   //  pokus nacist opesol
   // http://opesol.org/wwwSPRT/preklad.z.EN.do.FR.001.html
   function nactiOPESOL()
   {
     alert("NactiOPESOL");
     $.ajax({
        type:"GET",
        url:"http://opesol.org/wwwSPRT/preklad.z.EN.do.FR.001.html",
        success:function(data){alert("SUCCESS" + data)},
        error:function(data){alert("error = "+data)}
     });

   }
   
   
   
  </script>

</head>

<body>

 <!-- *****  animace pro cekani *****   -->
 <div id="waitblock" class="waitblock1">
 
 <div >
   <div id="helptx">
   nic 
   </div>
  <!--  <img alt="" class="waitobr" src="pes.jpg">   -->

 </div>
</div>


  <!-- animace pres vsechno  -->
  <div id="krizek" class="obranim">
   <img src="bad.png"/>
  </div>
  
<!-- *********************************** -->



<div id="afui" class="android">



     <div id="header"></div>
    
    <div id="content" style="">

   <!-- ************  P A N E L   Zkouseni *****************************   -->
    <div class="panel bgzkousej" title="Learning" id="Zkouseni" style="overflow:hidden" selected="selected">

              <div id="myhead" class="myhead" >

                <div id="idtext" class="text" >
                   <div id="znam"   class="skore" >
                     <span  id="znamx">0</span>
                   </div>
                   <div id="neznam" class="skore" >
                     <span  id="neznamx">0</span>
                   </div>
                   <div id="celkem" class="skore" >
                     <span  id="celkemx">0</span>
                   </div>
                </div>
                
                <div id="mysipka" class="mysipka" >
                  &nbsp;
                </div>
              </div>
                       
              <div id="slovo" class="slovo" >
              
              
              </div>
                

            <div class="tlacidla" >      
                <a class="greatb bgsipup"   
                          onclick="znam();">OK</a>
                <a class="greatb bgsipdn"   
                          onclick="neznam();">Learn</a>
            </div>
            <div class="tlacidla2" >      
                <a class="littleb"   
                          onclick="animHelp();">Help</a>
                <a class="littleb"   
                          onclick="DBAPI.audio();">Audio</a>
                <hr/>          
                <a class="littleb" id="idkill"  
                          onclick="DBAPI.kill();canim('#idkill','animated bounce',1500);">Kill</a>
            </div>
            
        </div>
        
        <!-- ************  P A N E L   Kviz *****************************   -->
        <div class="panel bgkviz" title="Kvízz" data-nav="nav_0" id="Kviz" >
        T e s t
        
        </div>
        
        
        <!-- ************  P A N E L   historie *****************************   -->
        <div class="panel" title="Historie učení" data-nav="nav_0" id="Historie" 
        data-appbuilder-object="page" data-transition="pop"
        style="">
        
                   
        <div id="idhis">Nevyplneno ??</div>
        

        </div>
        
        <!-- ************  P A N E L   Nastaveni *****************************   -->        
        <div class="panel" title="Setup" data-nav="nav_0" id="nastav" 
        style="">

        <hr/>
         <a class="button"   
           onclick="javascript:DBAPI.nactiDataReset(path_dramatik,'DBdata.txt');">Lesson from DRAMATIKA</a>
       <hr/>

       <div class="button-grouped vertical">
         
        <a class="button  big"   
           onclick="javascript:DBAPI.nactiDataReset(path_android_asset_data,'DBdata.txt');">Lesson from APK</a>
        
        <a class="button  big"   
           onclick="javascript:DBAPI.nactiDataReset(path_dramatik,'DBdata.txt');">from http://www.dramatik.cz</a>
        
        <a class="button  big"   
           onclick="javascript:DBAPI.nactiDataReset(path_jarda,'');">from http://www.opesol.org</a> <!-- http://www.opesol.org/wwwSPRT/DATA/GS/w.xy.html je uz prelozeny setri mou kreditni kartu-->
        
        <a class="button big"   
           onclick="javascript:DBAPI.nactiDataReset(path_extSdCard,'DBdata.txt');">Lessson from Memory Card</a>
        
        <a class="button big"   
           onclick="javascript:DBAPI.nactiDataReset(path_local,'DBdata.txt');">Lesson from local memory</a>
         
        </div>
        <br/>

        <a class="button big"   
           onclick="javascript:$.ui.setTitle('ZMENA NADPISU');">Change heading</a>
                  

                  <hr/>

                  <hr/>
                  <!-- <a class="button red" onclick="actionmy();">actionmy</a>   -->  
                  <a href="#logpage"  class="button red">Log history</a>
                   
       <h1>Zařízení</h1>
        <table>
          <tr>
           <td>Verze cordova : </td>
           <td><span id="vercor">Device: U N K N O W N </span></td>
          </tr>
          <tr>
           <td></td>
           <td></td>
          </tr>
        </table>
        <h1>Current Lesson:</h1>
        <div id="lastlekce">Lesson not in yet?</div>
        <a class="button slate"   
           onclick="alert('isChrome = ' + isChrome);">Chrome text out</a>
 
        <a class="button slate"   
           onclick="animHelp();">Animation HELP</a>

        <a class="button slate"   
           onclick="nactiOPESOL();">read from OPESOL</a>
 
                  
                  
       </div>  <!-- konec panelu Nastaveni -->
        
        
        
        <!-- log panel -->
        <div class="panel" title="Log panel" id="logpage" 
         style="overflow:auto; height:750px;" 
        data-nav="nav_0" data-footer="none"  >
            <h1>Log </h1>
 		<ul id="logtxt" class="list" style="overflow:auto; height:750px;" 
 		    data-appbuilder-object="list" data-position="static" style="z-index: 0;">

			     
		</ul>    
		</div>
    
    </div> <!-- konec Content -->
 
    <div id="navbar">
        <a href="#Zkouseni" class="icon home">Learn</a><a href="#Kviz" class="icon picture">Test</a>
        <a href="#Historie" class="icon info">Stat</a><a href="#nastav" class="icon settings">Setup</a>
    </div>
    <header id="header_0" data-appbuilder-object="header">
        <a id="backButton" href="#" class="button back" style="visibility: visible; ">Back</a>
        <h1 id="pageTitle" class="">Test</h1> 
    </header>
    <nav id="nav_0" data-appbuilder-object="nav">
        <h1>Learn</h1>
    </nav>
</div>


        <script type="text/javascript" src="cordova.js"></script>
        <script type="text/javascript" src="js/index.js"></script>
        <script type="text/javascript">
          app.initialize();
        </script> 
        
</body>        
</html>